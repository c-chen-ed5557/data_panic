{% block head %}
    <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/script.js') }}"></script>
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css?family=VT323&display=swap" rel="stylesheet">
{% endblock %}


{% block body %}
    <div id="container">
    <p id="user_name">No User</p>
    <p id="message"></p>
	<p id="user_resources">None</p>
	<video id='video' autoplay='autoplay' width="480" height="320" src=""></video>
    </div>
    <div id="totems">
        <img class="totem" src="{{ url_for('static', filename='images/text.svg') }}">
        <img class="totem" src="{{ url_for('static', filename='images/image.svg') }}">
        <img class="totem" src="{{ url_for('static', filename='images/sound.svg') }}">
        <img class="totem" src="{{ url_for('static', filename='images/video.svg') }}">
    </div>

    <script type="text/javascript">
        var video = document.getElementById("video");

        video.addEventListener('ended', function () {
            $('#video').attr('src', '');
            $('#video').attr('autoplay', 'autoplay');
            $('#video')[0].load();
            $('#message').html('You query is finished. What else do you want from us?')
        })

        var videoList = [];

        $(document).ready(function () {
            namespace = '/conn';
            var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);
            socket.on('server_response', function (res) {
                console.log(res.data);
                // $('#user_uid').html(res.data.user_uid);
                if(res.data.user_name !== 'No User') {
                    $('#user_name').html('Greetings, ' + res.data.user_name + '!');
                    $('#message').html(res.data.message)
                    // $('#user_result').html(res.data.user_result);
                    $('#user_resources').html('You still have ' + res.data.user_resources + ' points.');
                }
                if(res.data.user_choice == 'video') {
                    $("#video").attr('src', "https://www.w3schools.com/html/mov_bbb.mp4");
                    $("#video")[0].load();
                }
            })
        })
    </script>
{% endblock %}
